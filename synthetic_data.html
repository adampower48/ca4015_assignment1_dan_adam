
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Generating Synthetic Data &#8212; CA4015 Assignment 1 Book</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Conclusions" href="conclusion.html" />
    <link rel="prev" title="Clustering" href="clustering.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/dcu_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4015 Assignment 1 Book</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="data_exploration.html">
   Data Exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clustering.html">
   Clustering
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Generating Synthetic Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conclusion.html">
   Conclusions
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/synthetic_data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/adampower48/ca4015_assignment1_dan_adam"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choosing-the-distributions">
   Choosing the distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling-a-single-parameter">
   Modelling a single parameter
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-to-all-parameters">
     Applying to all parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-new-data">
     Generating new data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling-the-smaller-groups">
   Modelling the smaller groups
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#young">
     Young
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#old">
     Old
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#type-a">
       Type A
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#type-b">
       Type B
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#putting-the-groups-back-together">
     Putting the groups back together
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="generating-synthetic-data">
<h1>Generating Synthetic Data<a class="headerlink" href="#generating-synthetic-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="choosing-the-distributions">
<h2>Choosing the distributions<a class="headerlink" href="#choosing-the-distributions" title="Permalink to this headline">¶</a></h2>
<p>The parameters seem to follow 3 distinct distributions:</p>
<ul class="simple">
<li><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">Normal distribution</a>: Both <span class="math notranslate nohighlight">\(\beta_F\)</span> and <span class="math notranslate nohighlight">\(\beta_P\)</span> seem to be normally distributed. This is parameterised by the mean <span class="math notranslate nohighlight">\(\mu\)</span> (loc) and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> (scale) of the data.</p></li>
<li><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Beta_distribution">Beta distribution</a>: A+ and A- are within the range [0, 1], which means we can use this distribution to model them. The beta distribution can be used to model a large variety of distributions within this range with shape parameters <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>.</p></li>
<li><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Gamma_distribution">Gamma distribution</a>: Finally, the K parameter seems to roughly follow a poisson distribution which would represent the rate of decay. As the poisson distribution is only valid for integer values, we can use the gamma function as a continuous approximation. The gamma function is parameterised by shape <span class="math notranslate nohighlight">\(\alpha\)</span> and scale <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
</ul>
<p>Details of the functions used to model the distributions can be found here: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">Normal</a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.beta.html">Beta</a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.gamma.html">Gamma</a></p>
</div>
<div class="section" id="modelling-a-single-parameter">
<h2>Modelling a single parameter<a class="headerlink" href="#modelling-a-single-parameter" title="Permalink to this headline">¶</a></h2>
<p>Here we show show fitting the normal distribution works for the <span class="math notranslate nohighlight">\(\beta_P\)</span> parameter. The plot shows the fitted distribution in orange against the real data in blue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;BetaP&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean:&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;std:&quot;</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean: 0.008024174333333326
std: 5.455980769684062
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;BetaP&quot;</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/synthetic_data_7_0.png" src="_images/synthetic_data_7_0.png" />
</div>
</div>
<div class="section" id="applying-to-all-parameters">
<h3>Applying to all parameters<a class="headerlink" href="#applying-to-all-parameters" title="Permalink to this headline">¶</a></h3>
<p>First we define functions to fit each of the model parameters to their distributions.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_norm</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="n">loc</span><span class="p">,</span>
        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="n">scale</span>
    <span class="p">}</span>

<span class="k">def</span> <span class="nf">fit_beta</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">floc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span>
        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span>
        <span class="p">}</span>

<span class="k">def</span> <span class="nf">fit_gamma</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">floc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span>
        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="n">scale</span>
        <span class="p">}</span>

<span class="k">def</span> <span class="nf">fit_all_params</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;A+&quot;</span><span class="p">:</span> <span class="n">fit_beta</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A+&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;A-&quot;</span><span class="p">:</span> <span class="n">fit_beta</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A-&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="n">fit_gamma</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;BetaF&quot;</span><span class="p">:</span> <span class="n">fit_norm</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BetaF&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;BetaP&quot;</span><span class="p">:</span> <span class="n">fit_norm</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BetaP&quot;</span><span class="p">]),</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can apply this across all of our parameters to get model each one.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-stdout --no-display
<span class="n">dist_params</span> <span class="o">=</span> <span class="n">fit_all_params</span><span class="p">(</span><span class="n">df_orl</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.706595</td>
      <td>2.712327</td>
      <td>1.901708</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4.393497</td>
      <td>30.392386</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scale</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.434961</td>
      <td>1.096704</td>
      <td>5.455981</td>
    </tr>
    <tr>
      <th>loc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.635854</td>
      <td>0.008024</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">model_param</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist_params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    
    <span class="c1"># Generate points to draw distribution</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df_orl</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;A+&quot;</span><span class="p">,</span> <span class="s2">&quot;A-&quot;</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_param</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;BetaF&quot;</span><span class="p">,</span> <span class="s2">&quot;BetaP&quot;</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
        
    <span class="c1"># Draw plots</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="n">model_param</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Formatting</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">model_param</span><span class="p">)</span>

    
<span class="c1"># Hide unused plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/synthetic_data_13_0.png" src="_images/synthetic_data_13_0.png" />
</div>
</div>
</div>
<div class="section" id="generating-new-data">
<h3>Generating new data<a class="headerlink" href="#generating-new-data" title="Permalink to this headline">¶</a></h3>
<p>By modelling these parameters, we can create new data by sampling from their distributions. The generated parameters could then be used to create ORL models, each representing a synthetic person.<br />
For now we assume that each parameter is <strong>independent</strong>, though this may not be the case in reality.
Here we generate 5000 fake data points based on the entire dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">synth_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">model_param</span><span class="p">,</span> <span class="n">d_params</span> <span class="ow">in</span> <span class="n">dist_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;A+&quot;</span><span class="p">,</span> <span class="s2">&quot;A-&quot;</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_params</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_param</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_params</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;BetaF&quot;</span><span class="p">,</span> <span class="s2">&quot;BetaP&quot;</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_params</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        
    <span class="n">synth_data</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
    
<span class="n">synth_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.261309</td>
      <td>0.168667</td>
      <td>1.779280</td>
      <td>1.730511</td>
      <td>-1.495619</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.078284</td>
      <td>0.051535</td>
      <td>1.707949</td>
      <td>-0.321549</td>
      <td>1.474896</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.069887</td>
      <td>0.027349</td>
      <td>0.190077</td>
      <td>3.100703</td>
      <td>7.771008</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.280990</td>
      <td>0.110216</td>
      <td>1.770626</td>
      <td>1.809806</td>
      <td>3.781819</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.144279</td>
      <td>0.168102</td>
      <td>1.097024</td>
      <td>2.331919</td>
      <td>1.293506</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">synth_data</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">hist_kwds</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/synthetic_data_17_0.png" src="_images/synthetic_data_17_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="modelling-the-smaller-groups">
<h2>Modelling the smaller groups<a class="headerlink" href="#modelling-the-smaller-groups" title="Permalink to this headline">¶</a></h2>
<p>As we saw when we explored the data and during clustering, the young and old groups differ quite a bit, so we can’t really model the entire dataset with a single distribution for each parameter. We can apply the same methods to model each of these groups and generate new data for them. Here we split the old group into “Type A” (low BetaP values) and “Type B” (high BetaP values).</p>
<div class="section" id="young">
<h3>Young<a class="headerlink" href="#young" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-stdout --no-display

<span class="n">df_orl_young</span> <span class="o">=</span> <span class="n">df_orl</span><span class="p">[</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;subjID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;young&quot;</span><span class="p">]</span>
<span class="n">dist_params_young</span> <span class="o">=</span> <span class="n">fit_all_params</span><span class="p">(</span><span class="n">df_orl_young</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_params_young</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>3.655719</td>
      <td>2.989598</td>
      <td>3.477007</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>14.445001</td>
      <td>36.231395</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scale</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.177327</td>
      <td>1.077317</td>
      <td>3.056362</td>
    </tr>
    <tr>
      <th>loc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.552756</td>
      <td>-0.767603</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="old">
<h3>Old<a class="headerlink" href="#old" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-stdout --no-display

<span class="n">df_orl_old</span> <span class="o">=</span> <span class="n">df_orl</span><span class="p">[</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;subjID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;old&quot;</span><span class="p">]</span>
<span class="n">dist_params_old</span> <span class="o">=</span> <span class="n">fit_all_params</span><span class="p">(</span><span class="n">df_orl_old</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_params_old</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.538382</td>
      <td>2.499188</td>
      <td>1.502358</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.583400</td>
      <td>25.265530</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scale</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.750838</td>
      <td>1.113110</td>
      <td>7.540629</td>
    </tr>
    <tr>
      <th>loc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.754565</td>
      <td>1.116063</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta_p_split</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="type-a">
<h4>Type A<a class="headerlink" href="#type-a" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-stdout --no-display

<span class="n">df_orl_old_a</span> <span class="o">=</span> <span class="n">df_orl</span><span class="p">[(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;subjID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;old&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;BetaP&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">beta_p_split</span><span class="p">)]</span>
<span class="n">dist_params_old_a</span> <span class="o">=</span> <span class="n">fit_all_params</span><span class="p">(</span><span class="n">df_orl_old_a</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_params_old_a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.423581</td>
      <td>2.785678</td>
      <td>1.161286</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.106115</td>
      <td>30.929010</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scale</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.785322</td>
      <td>0.947348</td>
      <td>5.082615</td>
    </tr>
    <tr>
      <th>loc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.191551</td>
      <td>-3.315467</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="type-b">
<h4>Type B<a class="headerlink" href="#type-b" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-stdout --no-display

<span class="n">df_orl_old_b</span> <span class="o">=</span> <span class="n">df_orl</span><span class="p">[(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;subjID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;old&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_orl</span><span class="p">[</span><span class="s2">&quot;BetaP&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">beta_p_split</span><span class="p">)]</span>
<span class="n">dist_params_old_b</span> <span class="o">=</span> <span class="n">fit_all_params</span><span class="p">(</span><span class="n">df_orl_old_b</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_params_old_b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2.318003</td>
      <td>2.263055</td>
      <td>18.985592</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>5.303646</td>
      <td>19.375619</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>scale</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.082174</td>
      <td>0.881113</td>
      <td>1.042388</td>
    </tr>
    <tr>
      <th>loc</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.880591</td>
      <td>9.979123</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to draw row of plots</span>
<span class="k">def</span> <span class="nf">draw_dist_fit</span><span class="p">(</span><span class="n">dist_params</span><span class="p">,</span> <span class="n">data_df</span><span class="p">,</span> <span class="n">ax_row</span><span class="p">,</span> <span class="n">y_label</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">model_param</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist_params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    
        <span class="c1"># Generate points to draw beta</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data_df</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;A+&quot;</span><span class="p">,</span> <span class="s2">&quot;A-&quot;</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_param</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;BetaF&quot;</span><span class="p">,</span> <span class="s2">&quot;BetaP&quot;</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">d_params</span><span class="p">)</span>
        
        
        <span class="c1"># Draw plots</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="n">model_param</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
    <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Plots</span>
<span class="n">draw_dist_fit</span><span class="p">(</span><span class="n">dist_params_young</span><span class="p">,</span> <span class="n">df_orl_young</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Young&quot;</span><span class="p">)</span>
<span class="n">draw_dist_fit</span><span class="p">(</span><span class="n">dist_params_old</span><span class="p">,</span> <span class="n">df_orl_old</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Old&quot;</span><span class="p">)</span>
<span class="n">draw_dist_fit</span><span class="p">(</span><span class="n">dist_params_old_a</span><span class="p">,</span> <span class="n">df_orl_old_a</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Old - Type A&quot;</span><span class="p">)</span>
<span class="n">draw_dist_fit</span><span class="p">(</span><span class="n">dist_params_old_b</span><span class="p">,</span> <span class="n">df_orl_old_b</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Old - Type B&quot;</span><span class="p">)</span>

<span class="c1"># Param titles</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dist_params_old_b</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/synthetic_data_31_0.png" src="_images/synthetic_data_31_0.png" />
</div>
</div>
<p>This lets us compare the parameters across each of the different groups. We can see that the A+ and A- parameters are fairly similar for all of the groups, spread out with a slight skew to the left.<br />
The K parameter shows a difference between young and old, concentrated centrally versus much more uniform. There is a large variety in the distributions across groups, so the gamma distribution struggles to fit these well. More data may be needed in this case to start being able to see the underlying distributions.<br />
The <span class="math notranslate nohighlight">\(\beta_F\)</span> parameter is normally distributed for both the young and old (type A) groups, however with the type B group we see a degredation in the normal shape, being much closer to a uniform distribution.<br />
Finally the <span class="math notranslate nohighlight">\(\beta_P\)</span> parameter clearly shows the three distinct normal distributions. Notably the type B group has much higher values than both the young and type A groups which have similar distributions. In <a class="reference external" href="http://www.labsi.org/cognitive/Becharaetal1997.pdf">Bechara, et al. (1997)</a>, they note that participants with damage to their prefrontal cortex continue to choose bad decks even in the face of punishing outcomes, so the high value of perserverance for this group could be explained by this.</p>
<div class="section" id="putting-the-groups-back-together">
<h3>Putting the groups back together<a class="headerlink" href="#putting-the-groups-back-together" title="Permalink to this headline">¶</a></h3>
<p>Finally we can put all of this together to model the entire dataset. We generate new samples for each group in proportion to their representation in the entire dataset.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;young&quot;</span><span class="p">,</span> <span class="s2">&quot;old - type A&quot;</span><span class="p">,</span> <span class="s2">&quot;old - type B&quot;</span><span class="p">]</span>
<span class="n">dist_params_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dist_params_young</span><span class="p">,</span> <span class="n">dist_params_old_a</span><span class="p">,</span> <span class="n">dist_params_old_b</span><span class="p">]</span>
<span class="n">group_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">df_orl_young</span><span class="p">,</span> <span class="n">df_orl_old_a</span><span class="p">,</span> <span class="n">df_orl_old_b</span><span class="p">]]</span>

<span class="n">synth_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">dist_params</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">dist_params_list</span><span class="p">,</span> <span class="n">group_sizes</span><span class="p">):</span>
    <span class="n">synth_single</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">model_param</span><span class="p">,</span> <span class="n">d_param</span> <span class="ow">in</span> <span class="n">dist_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Sample data from distribution</span>
        <span class="k">if</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;A+&quot;</span><span class="p">,</span> <span class="s2">&quot;A-&quot;</span><span class="p">):</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_param</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_param</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_param</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">model_param</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;BetaF&quot;</span><span class="p">,</span> <span class="s2">&quot;BetaP&quot;</span><span class="p">):</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="o">**</span><span class="n">d_param</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
        
        <span class="n">synth_single</span><span class="p">[</span><span class="n">model_param</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
        
    <span class="n">synth_single</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span>
    <span class="n">synth_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">synth_single</span><span class="p">)</span>
        
<span class="n">synth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">synth_dataframes</span><span class="p">)</span>
<span class="n">synth_df</span><span class="p">[</span><span class="s2">&quot;group_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">synth_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>  <span class="c1"># Add group label</span>
<span class="n">synth_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
      <th>group</th>
      <th>group_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2965</th>
      <td>0.400275</td>
      <td>0.058571</td>
      <td>0.934803</td>
      <td>1.929026</td>
      <td>4.281307</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5440</th>
      <td>0.077169</td>
      <td>0.178693</td>
      <td>0.285304</td>
      <td>2.687541</td>
      <td>2.052571</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3648</th>
      <td>0.352947</td>
      <td>0.185282</td>
      <td>0.591703</td>
      <td>1.080223</td>
      <td>0.316973</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3896</th>
      <td>0.221789</td>
      <td>0.048638</td>
      <td>0.613568</td>
      <td>1.581120</td>
      <td>1.723694</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7432</th>
      <td>0.190310</td>
      <td>0.086048</td>
      <td>0.680496</td>
      <td>-0.350009</td>
      <td>-2.353153</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3528</th>
      <td>0.105519</td>
      <td>0.043896</td>
      <td>0.606347</td>
      <td>-0.178767</td>
      <td>0.474887</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7423</th>
      <td>0.114843</td>
      <td>0.057351</td>
      <td>0.329670</td>
      <td>0.561362</td>
      <td>-3.587337</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8149</th>
      <td>0.221485</td>
      <td>0.030208</td>
      <td>0.449922</td>
      <td>1.868200</td>
      <td>-2.639348</td>
      <td>young</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1594</th>
      <td>0.463105</td>
      <td>0.062203</td>
      <td>1.660785</td>
      <td>0.320503</td>
      <td>9.905021</td>
      <td>old - type B</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7429</th>
      <td>0.131248</td>
      <td>0.074713</td>
      <td>0.764382</td>
      <td>2.553813</td>
      <td>1.204364</td>
      <td>young</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">synth_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;group_label&quot;</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">hist_kwds</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">synth_df</span><span class="p">[</span><span class="s2">&quot;group_label&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/synthetic_data_35_0.png" src="_images/synthetic_data_35_0.png" />
</div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="clustering.html" title="previous page">Clustering</a>
    <a class='right-next' id="next-link" href="conclusion.html" title="next page">Conclusions</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Daniel O'Boyle and Adam Power<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>